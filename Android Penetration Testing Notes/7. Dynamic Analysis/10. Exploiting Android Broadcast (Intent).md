## 1. Intent Sniffing Practical

*I have an APK for intent sniffing. It may work by changing the code and recompiling the application to the tested package name. Message me if you need it.*

## 2. Practical

Let’s analyse the code using `jadx-gui`. Under the **LoginActivity** we have `broadcastIntent()` method. Let’s explore it.
![image](https://github.com/user-attachments/assets/65b37332-235f-4746-894d-8de66be0e986)

## 3. Creates an Intent

```java
Intent intent = new Intent();
```

Initializes a new Android `Intent` object (used for messaging between app components).

## 4. Sets a Custom Action

```java
intent.setAction("com.ecardsandkeys.E_INTENT");
```

Defines a custom action string (`com.ecardsandkeys.E_INTENT`) to identify the broadcast. Other apps can listen for this action.

## 5. Adds a Flag (32)

```java
intent.addFlags(32);
```

`32 = FLAG_INCLUDE_STOPPED_PACKAGES` (deprecated):

* Ensures the broadcast reaches apps that are stopped (not running).
* **Risk:** Malicious apps can exploit this to receive sensitive data even when inactive.

## 6. Attaches Sensitive Data

```java
intent.putExtra("value", SharedPreferences.getInstance().getString(SharedPreferencesKeys.AUTH_TOKEN));
```

Retrieves an authentication token from `SharedPreferences` and adds it to the intent as an extra (`key: "value"`).

## 7. Broadcasts the Intent Globally

```java
getApplicationContext().sendBroadcast(intent);
```

Sends the intent as a public broadcast, making it accessible to:

* Other apps on the device.
* Malware listening for `com.ecardsandkeys.E_INTENT`.

## 8. Testing with Intent Sniffer

* Installed intent sniffer APK in emulator.

![image](https://github.com/user-attachments/assets/c4664782-6bc2-4986-9ad8-ef9f5ccc1b4d)

* Logged in to the application to see if the intent gets captured.

![image](https://github.com/user-attachments/assets/0ce415c1-9aa9-4e0c-9ba8-91fa52a0c54f)


**Result:** Intent gets captured — the authorization token is exposed in cleartext.

![image](https://github.com/user-attachments/assets/e2a01917-dfd0-453b-8f86-48222546c4c7)


## 9. Android Oreo (8.0+) Restrictions

* `startService()` limitations:
  Throws `IllegalStateException` if the app is not in the foreground.
